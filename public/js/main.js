var deckOfCards = [
  {
    cardType: 2,
    cardValue: 2,
    cardSuite: "Hearts",
    cardImage: "images/2_of_hearts.svg"
  },
  {
    cardType: 3,
    cardValue: 3,
    cardSuite: "Hearts",
    cardImage: "images/3_of_hearts.svg"
  },
  {
    cardType: 4,
    cardValue: 4,
    cardSuite: "Hearts",
    cardImage: "images/4_of_hearts.svg"
  },
  {
    cardType: 5,
    cardValue: 5,
    cardSuite: "Hearts",
    cardImage: "images/5_of_hearts.svg"
  },
  {
    cardType: 6,
    cardValue: 6,
    cardSuite: "Hearts",
    cardImage: "images/6_of_hearts.svg"
  },
  {
    cardType: 7,
    cardValue: 7,
    cardSuite: "Hearts",
    cardImage: "images/7_of_hearts.svg"
  },
  {
    cardType: 8,
    cardValue: 8,
    cardSuite: "Hearts",
    cardImage: "images/8_of_hearts.svg"
  },
  {
    cardType: 9,
    cardValue: 9,
    cardSuite: "Hearts",
    cardImage: "images/9_of_hearts.svg"
  },
  {
    cardType: 10,
    cardValue: 10,
    cardSuite: "Hearts",
    cardImage: "images/10_of_hearts.svg"
  },
  {
    cardType: "Jack",
    cardValue: 10,
    cardSuite: "Hearts",
    cardImage: "images/jack_of_hearts.svg"
  },
  {
    cardType: "Queen",
    cardValue: 10,
    cardSuite: "Hearts",
    cardImage:"images/queen_of_hearts.svg"
  },
  {
    cardType: "King",
    cardValue: 10,
    cardSuite: "Hearts",
    cardImage:"images/king_of_hearts.svg"
  },
  {
    cardType: "Ace",
    cardValue: 11,
    cardSuite: "Hearts",
    cardImage: "images/ace_of_hearts.svg"
  },
  {
    cardType: 2,
    cardValue: 2,
    cardSuite: "Diamonds",
    cardImage: "images/2_of_diamonds.svg"
  },
  {
    cardType: 3,
    cardValue: 3,
    cardSuite: "Diamonds",
    cardImage:"images/3_of_diamonds.svg"
  },
  {
    cardType: 4,
    cardValue: 4,
    cardSuite: "Diamonds",
    cardImage:"images/4_of_diamonds.svg"
  },
  {
    cardType: 5,
    cardValue: 5,
    cardSuite: "Diamonds",
    cardImage:"images/5_of_diamonds.svg"
  },
  {
    cardType: 6,
    cardValue: 6,
    cardSuite: "Diamonds",
    cardImage:"images/6_of_diamonds.svg"
  },
  {
    cardType: 7,
    cardValue: 7,
    cardSuite: "Diamonds",
    cardImage:"images/7_of_diamonds.svg"
  },
  {
    cardType: 8,
    cardValue: 8,
    cardSuite: "Diamonds",
    cardImage:"images/8_of_diamonds.svg"
  },
  {
    cardType: 9,
    cardValue: 9,
    cardSuite: "Diamonds",
    cardImage:"images/9_of_diamonds.svg"
  },
  {
    cardType: 10,
    cardValue: 10,
    cardSuite: "Diamonds",
    cardImage:"images/10_of_diamonds.svg"
  },
  {
    cardType: "Jack",
    cardValue: 10,
    cardSuite: "Diamonds",
    cardImage:"images/jack_of_diamonds.svg"
  },
  {
    cardType: "Queen",
    cardValue: 10,
    cardSuite: "Diamonds",
    cardImage:"images/queen_of_diamonds.svg"
  },
  {
    cardType: "King",
    cardValue: 10,
    cardSuite: "Diamonds",
    cardImage:"images/king_of_diamonds.svg"
  },
  {
    cardType: "Ace",
    cardValue: 11,
    cardSuite: "Diamonds",
    cardImage:"images/ace_of_diamonds.svg"
  },
  {
    cardType: 2,
    cardValue: 2,
    cardSuite: "Clubs",
    cardImage:"images/2_of_clubs.svg"
  },
  {
    cardType: 3,
    cardValue: 3,
    cardSuite: "Clubs",
    cardImage:"images/3_of_clubs.svg"
  },
  {
    cardType: 4,
    cardValue: 4,
    cardSuite: "Clubs",
    cardImage:"images/4_of_clubs.svg"
  },
  {
    cardType: 5,
    cardValue: 5,
    cardSuite: "Clubs",
    cardImage:"images/5_of_clubs.svg"
  },
  {
    cardType: 6,
    cardValue: 6,
    cardSuite: "Clubs",
    cardImage:"images/6_of_clubs.svg"
  },
  {
    cardType: 7,
    cardValue: 7,
    cardSuite: "Clubs",
    cardImage:"images/7_of_clubs.svg"
  },
  {
    cardType: 8,
    cardValue: 8,
    cardSuite: "Clubs",
    cardImage:"images/8_of_clubs.svg"
  },
  {
    cardType: 9,
    cardValue: 9,
    cardSuite: "Clubs",
    cardImage:"images/9_of_clubs.svg"
  },
  {
    cardType: 10,
    cardValue: 10,
    cardSuite: "Clubs",
    cardImage:"images/10_of_clubs.svg"
  },
  {
    cardType: "Jack",
    cardValue: 10,
    cardSuite: "Clubs",
    cardImage:"images/jack_of_clubs.svg"
  },
  {
    cardType: "Queen",
    cardValue: 10,
    cardSuite: "Clubs",
    cardImage:"images/queen_of_clubs.svg"
  },
  {
    cardType: "King",
    cardValue: 10,
    cardSuite: "Clubs",
    cardImage:"images/king_of_clubs.svg"
  },
  {
    cardType: "Ace",
    cardValue: 11,
    cardSuite: "Clubs",
    cardImage:"images/ace_of_clubs.svg"
  },
  {
    cardType: 2,
    cardValue: 2,
    cardSuite: "Spades",
    cardImage:"images/2_of_spades.svg"
  },
  {
    cardType: 3,
    cardValue: 3,
    cardSuite: "Spades",
    cardImage:"images/3_of_spades.svg"
  },
  {
    cardType: 4,
    cardValue: 4,
    cardSuite: "Spades",
    cardImage:"images/4_of_spades.svg"
  },
  {
    cardType: 5,
    cardValue: 5,
    cardSuite: "Spades",
    cardImage:"images/5_of_spades.svg"
  },
  {
    cardType: 6,
    cardValue: 6,
    cardSuite: "Spades",
    cardImage:"images/6_of_spades.svg"
  },
  {
    cardType: 7,
    cardValue: 7,
    cardSuite: "Spades",
    cardImage:"images/7_of_spades.svg"
  },
  {
    cardType: 8,
    cardValue: 8,
    cardSuite: "Spades",
    cardImage:"images/8_of_spades.svg"
  },
  {
    cardType: 9,
    cardValue: 9,
    cardSuite: "Spades",
    cardImage:"images/9_of_spades.svg"
  },
  {
    cardType: 10,
    cardValue: 10,
    cardSuite: "Spades",
    cardImage:"images/10_of_spades.svg"
  },
  {
    cardType: "Jack",
    cardValue: 10,
    cardSuite: "Spades",
    cardImage:"images/jack_of_spades.svg"
  },
  {
    cardType: "Queen",
    cardValue: 10,
    cardSuite: "Spades",
    cardImage:"images/queen_of_spades.svg"
  },
  {
    cardType: "King",
    cardValue: 10,
    cardSuite: "Spades",
    cardImage:"images/king_of_spades.svg"
  },
  {
    cardType: "Ace",
    cardValue: 11,
    cardSuite: "Spades",
    cardImage:"images/ace_of_spades.svg"
  }
];

var BlackJack = {
  userRandomCards: [],
  userHand: 0,
  dealerRandomCards: [],
  dealerHand: 0,
  gameDealt: false,
  dealerStage: false,
  dealHand: function(){
    console.log("Hand Dealt!");
    AppHelpers.getRandomCard();
    AppHelpers.getRandomCard();
    BlackJack.dealerStage = true;
    AppHelpers.getRandomCard();
    AppHelpers.getRandomCard();
    BlackJack.dealerStage = false;
    BlackJack.checkForBlackJack();
  },
  hit: function(){
    AppHelpers.getRandomCard();
    BlackJack.checkForWin();
    if (BlackJack.userHand > 21) {
      setTimeout(function(){alert("Busted! You lose."); }, 500);
    }
  },
  stand: function(){
    BlackJack.dealerStage = true;
    BlackJack.checkForWin();
    console.log(BlackJack.dealerStage);
    while (BlackJack.dealerHand < 17) {
      setTimeout(AppHelpers.getRandomCard(), 1000);
      BlackJack.checkForWin();
    }
  },
  checkForBlackJack: function(){
    if (BlackJack.userHand === 21) {
      setTimeout(function(){ alert("BlackJack! You Win!"); }, 500);
    } else if (BlackJack.dealerHand === 21) {
      setTimeout(function(){ alert("Dealer has BlackJack, you lose."); }, 500);
    }
  },
  checkForWin: function() {
    if (BlackJack.userHand > BlackJack.dealerHand && BlackJack.userHand < 22 && BlackJack.dealerHand > 16) {
      setTimeout(function(){ alert("You Win!"); }, 500);
    } else if (BlackJack.dealerHand > BlackJack.userHand && BlackJack.dealerHand > 16 && BlackJack.dealerHand < 22 && BlackJack.dealerStage === true) {
      setTimeout(function(){ alert("You Lose"); }, 500);
    } else if (BlackJack.dealerHand === BlackJack.userHand && BlackJack.dealerHand > 16) {
      setTimeout(function(){ alert("You Tie"); }, 500);
    } else if(BlackJack.dealerHand > 21 && BlackJack.userHand < 22){
      setTimeout(function(){ alert("Dealer busted, you win!"); }, 500);
    }
  },
  reset: function(){
    BlackJack.userHand = 0;
    BlackJack.dealerHand = 0;
    BlackJack.gameDealt = false;
    BlackJack.dealerStage = false;
    $( ".card").remove();
  }

};
var AppHelpers = {
  getRandomCard: function(){
    var randomNumber = Math.floor(Math.random() * 52);
    var randomCard = deckOfCards[randomNumber];
    if (BlackJack.dealerStage === false) {
      BlackJack.userRandomCards.push(randomCard);
      BlackJack.userHand += randomCard.cardValue;
      $("#usercards").append(`<img class='card' src='${randomCard.cardImage}'/>`);
    } else if (BlackJack.dealerStage === true) {
      BlackJack.dealerRandomCards.push(randomCard);
      BlackJack.dealerHand += randomCard.cardValue;
      $("#dealercards").append(`<img class='card' src='${randomCard.cardImage}'/>`);
    }

  }
};

var AppController = {
  handleDeal: function(){
    if(BlackJack.gameDealt === false){
      BlackJack.gameDealt = true;
      BlackJack.dealHand();
    }
  },

  handleHit: function(){
    if (BlackJack.gameDealt === true && BlackJack.dealerStage === false) {
      BlackJack.hit();
    }
  },
  handleStand: function(){
    if (BlackJack.gameDealt === true && BlackJack.dealerStage === false) {
      BlackJack.stand();
    }
  },
  handleReset: function(){
    console.log("Reset works");
    BlackJack.reset();
  }
};

//event listeners
window.onload = function(){
  $('#deal_button').on('click', function(){
    AppController.handleDeal();
  });
  $('#hit_button').on('click', function(){
    AppController.handleHit();
  });
  $('#stand_button').on('click', function(){
    AppController.handleStand();
  });
  $('#reset_button').on('click', function(){
    AppController.handleReset();
  });
};
